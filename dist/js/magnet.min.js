let magnet,magnetPosition,mu=35,muSFriction=.15,muKFriction=.01,g=-9.8,movers=[],totalMovers=23,magnetQ=3e4,magnetDiameter=100,pressed=!1;var started=!1;function setup(){cnv=createCanvas(window.innerWidth,window.innerHeight),reset(),noLoop()}function startMagnets(){started=!0,loop()}function endMagnets(){started=!1,noLoop()}function draw(){if(started){background("#EAE4D7"),magnetPosition=createVector(mouseX,mouseY),push();for(let e=0;e<movers.length;e++){let t,o=movers[e].position.dist(magnetPosition),i=mu*magnetQ*movers[e].q/(4*Math.PI*Math.pow(o,4));t=pressed?p5.Vector.sub(movers[e].position,magnetPosition):p5.Vector.sub(magnetPosition,movers[e].position),t.normalize(),t.mult(i);let s=createVector(t.x,t.y);s.normalize();let r=createVector(movers[e].velocity.x,movers[e].velocity.y);if(r.normalize(),0==movers[e].velocity.mag()){let i=p5.Vector.mult(s,movers[e].mass*muSFriction*g);t.mag()>i.mag()&&(o>movers[e].radius+magnetDiameter/2?(movers[e].applyForce(t),movers[e].update(e)):o<movers[e].radius+magnetDiameter/2?movers[e].adjust(magnetPosition,magnetDiameter):movers[e].stop())}else{let i=p5.Vector.mult(r,movers[e].mass*muKFriction*g);t.mag()>i.mag()?o>movers[e].radius+magnetDiameter/2?(movers[e].applyForce(t),movers[e].update(e)):o<movers[e].radius+magnetDiameter/2?movers[e].adjust(magnetPosition,magnetDiameter):movers[e].stop():movers[e].velocity.mag()<.1?(movers[e].applyForce(i),movers[e].update(e)):movers[e].stop()}movers[e].display()}stroke(0),noFill(),strokeWeight(4),circle(magnetPosition.x,magnetPosition.y,magnetDiameter),pop()}}function mousePressed(){pressed=!0}function mouseReleased(){pressed=!1}function reset(){for(let e=0;e<totalMovers;e++)movers[e]=new Mover(random(0,width),random(0,height),random(15,25),color(random(0,255),random(0,255),random(0,255)))}function Mover(e,t,o,i){this.radius=o,this.mass=o/100,this.q=100*o,this.position=createVector(e,t),this.velocity=createVector(0,0),this.prevVelocity=createVector(0,0),this.acceleration=createVector(0,0),this.color=i}Mover.prototype.applyForce=function(e){let t=p5.Vector.div(e,this.mass);this.acceleration.add(t)},Mover.prototype.update=function(e){this.prevVelocity=createVector(this.velocity.x,this.velocity.y),this.velocity.add(this.acceleration);let t=p5.Vector.add(this.position,this.velocity);p5.Vector.dist(t,magnetPosition)<magnetDiameter/2+this.radius?this.adjust(magnetPosition,magnetDiameter):this.position.add(this.velocity);for(let o=0;o<movers.length;o++)o!=e&&p5.Vector.dist(t,movers[o].position)<movers[o].radius+this.radius&&this.adjust(movers[o].position,2*movers[o].radius);this.acceleration.mult(0)},Mover.prototype.stop=function(){this.velocity=createVector(0,0)},Mover.prototype.adjust=function(e,t){let o=p5.Vector.sub(this.position,e).normalize();o.mult(t/2+this.radius),this.position=p5.Vector.add(e,o),this.velocity=createVector(0,0)},Mover.prototype.display=function(){noStroke(),pressed?fill(color("#E94F37")):fill(color("#195CC8")),circle(this.position.x,this.position.y,2*this.radius)},Mover.prototype.collide=function(){};