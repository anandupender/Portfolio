let magnet,magnetPosition,mu=35,muSFriction=.15,muKFriction=.01,g=-9.8,movers=[],totalMovers=25,magnetQ=3e4,magnetDiameter=100,pressed=!1;var started=!1;function setup(){cnv=createCanvas(window.innerWidth,window.innerHeight),reset(),noLoop()}function startMagnets(){started=!0,loop()}function endMagnets(){started=!1,noLoop()}function draw(){if(started){background("#EAE4D7"),magnetPosition=createVector(mouseX,mouseY),push();for(let t=0;t<movers.length;t++){let e,o=movers[t].position.dist(magnetPosition),i=mu*magnetQ*movers[t].q/(4*Math.PI*Math.pow(o,4));e=pressed?p5.Vector.sub(movers[t].position,magnetPosition):p5.Vector.sub(magnetPosition,movers[t].position),e.normalize(),e.mult(i);let s=createVector(e.x,e.y);s.normalize();let r=createVector(movers[t].velocity.x,movers[t].velocity.y);if(r.normalize(),0==movers[t].velocity.mag()){let i=p5.Vector.mult(s,movers[t].mass*muSFriction*g);e.mag()>i.mag()&&(o>movers[t].radius+magnetDiameter/2?(movers[t].applyForce(e),movers[t].update(t)):o<movers[t].radius+magnetDiameter/2?movers[t].adjust(magnetPosition,magnetDiameter,!0):movers[t].stop())}else{let i=p5.Vector.mult(r,movers[t].mass*muKFriction*g);e.mag()>i.mag()?o>movers[t].radius+magnetDiameter/2?(movers[t].applyForce(e),movers[t].update(t)):o<movers[t].radius+magnetDiameter/2?movers[t].adjust(magnetPosition,magnetDiameter,!0):movers[t].stop():movers[t].velocity.mag()<.1?(movers[t].applyForce(i),movers[t].update(t)):movers[t].stop()}movers[t].display()}stroke(0),noFill(),strokeWeight(4),circle(magnetPosition.x,magnetPosition.y,magnetDiameter),pop()}}function mousePressed(){pressed=!0}function mouseReleased(){pressed=!1}function reset(){for(let t=0;t<totalMovers;t++)movers[t]=new Mover(random(0,width),random(0,height),random(18,25),color(random(0,255),random(0,255),random(0,255)))}function Mover(t,e,o,i){this.radius=o,this.mass=o/100,this.q=100*o,this.position=createVector(t,e),this.velocity=createVector(0,0),this.prevVelocity=createVector(0,0),this.acceleration=createVector(0,0),this.color=i}Mover.prototype.applyForce=function(t){let e=p5.Vector.div(t,this.mass);this.acceleration.add(e)},Mover.prototype.update=function(t){this.prevVelocity=createVector(this.velocity.x,this.velocity.y),this.velocity.add(this.acceleration);let e=p5.Vector.add(this.position,this.velocity);p5.Vector.dist(e,magnetPosition)<magnetDiameter/2+this.radius?this.adjust(magnetPosition,magnetDiameter,!1):this.position.add(this.velocity);for(let o=0;o<movers.length;o++)o!=t&&p5.Vector.dist(e,movers[o].position)<movers[o].radius+this.radius&&this.adjust(movers[o].position,2*movers[o].radius,!1);this.acceleration.mult(0)},Mover.prototype.stop=function(){this.velocity=createVector(0,0)},Mover.prototype.adjust=function(t,e,o){let i=p5.Vector.sub(this.position,t).normalize();if(i.mult(e/2+this.radius),this.position=p5.Vector.add(t,i),this.velocity=createVector(0,0),o)for(let t=0;t<movers.length;t++)p5.Vector.dist(this.position,movers[t].position)<movers[t].radius+this.radius&&this.adjust(movers[t].position,2*movers[t].radius,!1)},Mover.prototype.display=function(){noStroke(),pressed?fill(color("#E94F37")):fill(color("#195CC8")),circle(this.position.x,this.position.y,2*this.radius)},Mover.prototype.collide=function(){};