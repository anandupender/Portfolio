let mu=35;var muSFriction=.15,muSFrictionMin=.05,muSFrictionMax=.99,muSFrictionStep=.01,muKFriction=.01,muKFrictionMin=0,muKFrictionMax=.99,muKFrictionStep=.005;let magnet,g=-9.8,movers=[];var magnetQ=3e4,magnetQMin=1e3,magnetQMax=5e4,magnetQStep=1e3;let magnetPosition,magnetDiameter=100;var myColor,backgroundColor,totalMovers=25,totalMoversMin=0,totalMoversMax=1e3,totalMoversStep=1,prevTotalMovers=25;let pressed=!1;var gui,started=!1;function setup(){cnv=createCanvas(window.innerWidth,window.innerHeight),reset(),noLoop(),myColor=[25,92,200],backgroundColor=[234,228,215]}function startMagnets(t){t.gui&&(gui=createGui("Magnet Variables")).addGlobals("myColor","backgroundColor","muSFriction","muKFriction","magnetQ","totalMovers"),started=!0,loop(),totalMovers=t.num,reset()}function endMagnets(){started=!1,noLoop()}function draw(){if(totalMovers!==prevTotalMovers&&(prevTotalMovers=totalMovers,reset()),started){background(backgroundColor),magnetPosition=createVector(mouseX,mouseY),push();for(let t=0;t<movers.length;t++){let o,e=movers[t].position.dist(magnetPosition),r=mu*magnetQ*movers[t].q/(4*Math.PI*Math.pow(e,4));o=pressed?p5.Vector.sub(movers[t].position,magnetPosition):p5.Vector.sub(magnetPosition,movers[t].position),o.normalize(),o.mult(r);let i=createVector(o.x,o.y);i.normalize();let s=createVector(movers[t].velocity.x,movers[t].velocity.y);if(s.normalize(),0==movers[t].velocity.mag()){let r=p5.Vector.mult(i,movers[t].mass*muSFriction*g);o.mag()>r.mag()&&(e>movers[t].radius+magnetDiameter/2?(movers[t].applyForce(o),movers[t].update(t)):e<movers[t].radius+magnetDiameter/2?movers[t].adjust(magnetPosition,magnetDiameter,!0):movers[t].stop())}else{let r=p5.Vector.mult(s,movers[t].mass*muKFriction*g);o.mag()>r.mag()?e>movers[t].radius+magnetDiameter/2?(movers[t].applyForce(o),movers[t].update(t)):e<movers[t].radius+magnetDiameter/2?movers[t].adjust(magnetPosition,magnetDiameter,!0):movers[t].stop():movers[t].velocity.mag()<.1?(movers[t].applyForce(r),movers[t].update(t)):movers[t].stop()}movers[t].display()}stroke(0),fill(backgroundColor),strokeWeight(4),circle(magnetPosition.x,magnetPosition.y,magnetDiameter),pop()}}function mousePressed(){pressed=!0}function mouseReleased(){pressed=!1}function reset(){movers=[];for(let t=0;t<totalMovers;t++)movers[t]=new Mover(random(0,width),random(0,height),random(18,25),color(random(0,255),random(0,255),random(0,255)))}function Mover(t,o,e,r){this.radius=e,this.mass=e/100,this.q=100*e,this.position=createVector(t,o),this.velocity=createVector(0,0),this.prevVelocity=createVector(0,0),this.acceleration=createVector(0,0),this.color=myColor}Mover.prototype.applyForce=function(t){let o=p5.Vector.div(t,this.mass);this.acceleration.add(o)},Mover.prototype.update=function(t){this.prevVelocity=createVector(this.velocity.x,this.velocity.y),this.velocity.add(this.acceleration);let o=p5.Vector.add(this.position,this.velocity);p5.Vector.dist(o,magnetPosition)<magnetDiameter/2+this.radius?this.adjust(magnetPosition,magnetDiameter,!0):this.position.add(this.velocity);for(let e=0;e<movers.length;e++)e!=t&&p5.Vector.dist(o,movers[e].position)<movers[e].radius+this.radius&&this.adjust(movers[e].position,2*movers[e].radius,!0);this.acceleration.mult(0)},Mover.prototype.stop=function(){this.velocity=createVector(0,0)},Mover.prototype.adjust=function(t,o,e){let r=p5.Vector.sub(this.position,t).normalize();if(r.mult(o/2+this.radius),this.position=p5.Vector.add(t,r),this.velocity=createVector(0,0),e)for(let t=0;t<movers.length;t++)p5.Vector.dist(this.position,movers[t].position)<movers[t].radius+this.radius&&this.adjust(movers[t].position,2*movers[t].radius,!1)},Mover.prototype.display=function(){noStroke(),pressed?fill(color("#E94F37")):void 0!==myColor&&fill(myColor),circle(this.position.x,this.position.y,2*this.radius)},Mover.prototype.collide=function(){};